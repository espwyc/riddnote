<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
    <!--<meta name="viewport" mdcontent="width=device-width, initial-scale=1" />-->
    <meta name="viewport" mdcontent="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <meta charset="UTF-8" />
    <title>My title</title>

    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-80520768-3');
    </script>
    <!--Google Fonts-->
    <link th:href="@{/sidebar/css/gfont.css}" rel="stylesheet" />
    <!--jQuery-->
    <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
    <!--Material Design Iconic Font-->
    <link rel="stylesheet" th:href="@{/sidebar/material-design/css/material-design-iconic-font.css}" />

    <!--jSide Menu Plugin-->
    <script th:src="@{/sidebar/js/jquery.jside.menu.js}"></script>
    <!--jSide Menu CSS-->
    <link rel="stylesheet" th:href="@{/sidebar/css/jside-menu.css}" />
    <!--jSide Skins-->
    <link rel="stylesheet" th:href="@{/sidebar/css/jside-skins.css}" />

    <!--water fall-->
    <link rel="stylesheet" type="text/css" th:href="@{/waterfall/style/base.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/waterfall/style/index.css}">

    <!--[if lt IE 9]>
    <script th:src="@{/waterfall/js/css3-mediaqueries.js}"></script>
    <![endif]-->
    <!--<script type="text/javascript" th:src="@{/waterfall/js/jquery-1.8.3.min.js}"></script>-->
    <script type="text/javascript" th:src="@{/waterfall/js/jQueryColor.js}"></script>
    <!--这个插件是瀑布流主插件函数必须-->
    <script type="text/javascript" th:src="@{/waterfall/js/jquery.masonry.min.js}"></script>
    <!--这个插件只是为了扩展jquery的animate函数动态效果可有可无-->
    <script type="text/javascript" th:src="@{/waterfall/js/jQeasing.js}"></script>

    <!--sidebar script-->
    <script>
        $(document).ready(function(){

            $(".menu-container").jSideMenu({
                jSidePosition: "position-left", //possible options position-left or position-right

                jSideSticky: true, // menubar will be fixed on top, false to set static

                jSideSkin: "default-skin", // to apply custom skin, just put its name in this string
            });
        });
    </script>


</head>
<body >
<div id="layout" >

    <div class="endless-river menu-head position-left" >
   <span class="layer">
<div class="col">
  <div class="row for-pic">
   <div class="profile-pic">
   <img th:src="@{/sidebar/image/tmp.jpg}" alt="Asif Mughal" />
         </div>
  </div>
         <div class="row for-name">
   <h3 title="User Name" th:text="${userinfo.nickname}"> nichname</h3>
        <span class="tagline" th:text="${userinfo.intro}">intro</span>
          </div>
         </div> <!--//col-->
  </span>
    </div> <!--//menu-head-->

    <nav class="endless-river menu-container position-left" style="height: 100%">

        <ul class="menu-items">
            <!--<li><span class="item-icon"><i class="zmdi zmdi-android"></i></span> <a href="#1">-->
                <!--Main item one </a></li>-->

            <!--<li> <span class="item-icon"> <i class="zmdi zmdi-apple"></i> </span> <a href="#1">-->
                <!--Main item two </a></li>-->

            <!--<li class="has-sub"> <span class="item-icon"> <i class="zmdi zmdi-windows"></i> </span>-->
                <!--<span class="dropdown-heading">-->
 <!--Item three with dropdown </span>-->
                <!--<ul>-->
                    <!--<li> <a href="#2">dropdown sub item 1 </a> </li>-->
                    <!--<li> <a href="#2"> dropdown sub item 2 </a> </li>-->
                    <!--<li> <a href="#2"> dropdown sub item 3 </a> </li>-->
                    <!--<li> <a href="#2"> dropdown sub item 4 </a> </li>-->
                    <!--<li> <a href="#2"> dropdown sub item 5 </a> </li>-->
                    <!--<li> <a href="#2"> dropdown sub item 6 </a> </li>-->
                    <!--<li> <a href="#2"> dropdown sub item 7 </a> </li>-->
                <!--</ul>-->
            <!--</li>-->
            <!--<li class="has-sub"> <span class="item-icon"> <i class="zmdi zmdi-devices"></i> </span>-->
                <!--<span class="dropdown-heading">-->

 <!--Item four with dropdown </span>-->
                <!--<ul>-->
                    <!--<li> <a href="#2">sub item 1 </a> </li>-->
                    <!--<li> <a href="#2">sub item 2 </a> </li>-->
                    <!--<li> <a href="#2">sub item 3 </a> </li>-->
                    <!--<li> <a href="#2">sub item 4 </a> </li>-->
                <!--</ul>-->
            <!--</li>-->

            <!--<li> <span class="item-icon"> <i class="zmdi zmdi-keyboard"></i> </span> <a href="#1">-->
                <!--Main item four </a></li>-->

            <!--<li> <span class="item-icon"> <i class="zmdi zmdi-dock"></i> </span> <a href="#1">-->
                <!--Main item five </a></li>-->

            <!--<li> <span class="item-icon"> <i class="zmdi zmdi-mouse"></i> </span> <a href="#1">-->
                <!--Main item five </a></li>-->

            <!--<li> <span class="item-icon"> <i class="zmdi zmdi-tv"></i> </span> <a href="#1">-->
                <!--Main item six </a></li>-->

            <li> <span class="item-icon"> <i class="zmdi zmdi-file"></i> </span> <a  id="reload">
                刷新列表</a></li>

            <li> <span class="item-icon"> <i class="zmdi zmdi-file"></i> </span> <a onclick="newmd()">
                新建markdown</a></li>

            <li> <span class="item-icon"> <i class="zmdi zmdi-close"></i> </span> <a href="logout">
            退出登陆</a></li>

        </ul>

    </nav>


    <header >
        <menu class="endless-river menubar">
            <menuitem>
                <button class="menu-trigger"> </button>
            </menuitem>

            <menuitem class="logo" title="Your Logo Goes Here">
                <a href="#1"><img th:src="@{/sidebar/image/jside-menu.png}" alt="jSide Menu" /> </a>
            </menuitem>
        </menu>

    </header>

    <main id="mainp" style="width: 100%;margin-top: 60px">

        <div class="mdcontent" style="min-height: 900px">
            <!-- 瀑布流样式开始 -->
            <div class="waterfull clearfloat" id="waterfull" style="margin-left: 200px; margin-right: 200px">
                <ul>
                    <!--<li class="item">-->
                    <!--<a href="#" class="a-img">-->
                    <!--<img th:src="@{/waterfall/images/10.jpg}" alt="">-->

                    <!--</a>-->
                    <!--<h2 class="li-title" title="手把手教你用css3来创建loading动画(二)">手把手教你用css3来创建loading动画(二)</h2>-->
                    <!--<p class="description">HTML 5以前的标准由于考虑到浏览器安全问题并不允许直接跨域通信并不允许直接跨域通信并不允许直接跨域通信，于...</p>-->
                    <!--<div class="qianm clearfloat">-->
                    <!--<span class="sp1"><b>688</b>浏览</span>-->
                    <!--<span class="sp2">jq22</span>-->
                    <!--<span class="sp3">2小时前&nbsp;By</span>-->
                    <!--</div>-->
                    <!--</li>-->
                    <!--<li class="item">-->
                    <!--<a href="#" class="a-img">-->
                    <!--<img th:src="@{/waterfall/images/9.jpg}" alt="">-->

                    <!--</a>-->
                    <!--<h2 class="li-title" title="手把手教你用css3来创建loading动画(二)">手把手教你用css3来创建loading动画(二)</h2>-->
                    <!--<p class="description">HTML 5以前的标准由于考虑到浏览器安全问题并不允许直接跨域通信并不允许直接跨域通信并不允许直接跨域通信，于...</p>-->
                    <!--<div class="qianm clearfloat">-->
                    <!--<span class="sp1"><b>688</b>浏览</span>-->
                    <!--<span class="sp2">jq22</span>-->
                    <!--<span class="sp3">2小时前&nbsp;By</span>-->
                    <!--</div>-->
                    <!--</li>-->
                    <!--<li class="item">-->
                    <!--<a href="#" class="a-img">-->
                    <!--<img th:src="@{/waterfall/images/11.jpg}" alt="">-->

                    <!--</a>-->
                    <!--<h2 class="li-title" title="手把手教你用css3来创建loading动画(二)">手把手教你用css3来创建loading动画(二)</h2>-->
                    <!--<p class="description">HTML 5以前的标准由于考虑到浏览器安全问题并不允许直接跨域通信并不允许直接跨域通信并不允许直接跨域通信，于...</p>-->
                    <!--<div class="qianm clearfloat">-->
                    <!--<span class="sp1"><b>688</b>浏览</span>-->
                    <!--<span class="sp2">jq22</span>-->
                    <!--<span class="sp3">2小时前&nbsp;By</span>-->
                    <!--</div>-->
                    <!--</li>-->
                    <!--<li class="item">-->
                    <!--<a href="#" class="a-img">-->
                    <!--<img th:src="@{/waterfall/images/5.jpg}" alt="">-->

                    <!--</a>-->
                    <!--<h2 class="li-title" title="手把手教你用css3来创建loading动画(二)">手把手教你用css3来创建loading动画(二)</h2>-->
                    <!--<p class="description">HTML 5以前的标准由于考虑到浏览器安全问题并不允许直接跨域通信并不允许直接跨域通信并不允许直接跨域通信，于...</p>-->
                    <!--<div class="qianm clearfloat">-->
                    <!--<span class="sp1"><b>688</b>浏览</span>-->
                    <!--<span class="sp2">jq22</span>-->
                    <!--<span class="sp3">2小时前&nbsp;By</span>-->
                    <!--</div>-->
                    <!--</li>-->
                    <!--<li class="item">-->
                    <!--<a href="#" class="a-img">-->
                    <!--<img th:src="@{/waterfall/images/8.jpg}" alt="">-->

                    <!--</a>-->
                    <!--<h2 class="li-title" title="手把手教你用css3来创建loading动画(二)">手把手教你用css3来创建loading动画(二)</h2>-->
                    <!--<p class="description">HTML 5以前的标准由于考虑到浏览器安全问题并不允许直接跨域通信并不允许直接跨域通信并不允许直接跨域通信，于...</p>-->
                    <!--<div class="qianm clearfloat">-->
                    <!--<span class="sp1"><b>688</b>浏览</span>-->
                    <!--<span class="sp2">jq22</span>-->
                    <!--<span class="sp3">2小时前&nbsp;By</span>-->
                    <!--</div>-->
                    <!--</li>-->
                    <!--<li class="item">-->
                    <!--<a href="#" class="a-img">-->
                    <!--<img th:src="@{/waterfall/images/7.jpg}" alt="">-->
                    <!--</a>-->
                    <!--<h2 class="li-title" title="手把手教你用css3来创建loading动画(二)">手把手教你用css3来创建loading动画(二)</h2>-->
                    <!--<p class="description">HTML 5以前的标准由于考虑到浏览器安全问题并不允许直接跨域通信并不允许直接跨域通信并不允许直接跨域通信，于...</p>-->
                    <!--<div class="qianm clearfloat">-->
                    <!--<span class="sp1"><b>688</b>浏览</span>-->
                    <!--<span class="sp2">jq22</span>-->
                    <!--<span class="sp3">2小时前&nbsp;By</span>-->
                    <!--</div>-->
                    <!--</li>-->
                    <!--<li class="item">-->
                    <!--<a href="#" class="a-img">-->
                    <!--<img th:src="@{/waterfall/images/12.jpg}" alt="">-->

                    <!--</a>-->
                    <!--<h2 class="li-title" title="手把手教你用css3来创建loading动画(二)">手把手教你用css3来创建loading动画(二)</h2>-->
                    <!--<p class="description">HTML 5以前的标准由于考虑到浏览器安全问题并不允许直接跨域通信并不允许直接跨域通信并不允许直接跨域通信，于...</p>-->
                    <!--<div class="qianm clearfloat">-->
                    <!--<span class="sp1"><b>688</b>浏览</span>-->
                    <!--<span class="sp2">jq22</span>-->
                    <!--<span class="sp3">2小时前&nbsp;By</span>-->
                    <!--</div>-->
                    <!--</li>-->
                    <!--<li class="item">-->
                    <!--<a href="#" class="a-img">-->
                    <!--<img th:src="@{/waterfall/images/4.jpg}" alt="">-->

                    <!--</a>-->
                    <!--<h2 class="li-title" title="手把手教你用css3来创建loading动画(二)">手把手教你用css3来创建loading动画(二)</h2>-->
                    <!--<p class="description">HTML 5以前的标准由于考虑到浏览器安全问题并不允许直接跨域通信并不允许直接跨域通信并不允许直接跨域通信，于...</p>-->
                    <!--<div class="qianm clearfloat">-->
                    <!--<span class="sp1"><b>688</b>浏览</span>-->
                    <!--<span class="sp2">jq22</span>-->
                    <!--<span class="sp3">2小时前&nbsp;By</span>-->
                    <!--</div>-->
                    <!--</li>-->
                    <!--<li class="item">-->
                    <!--<a href="#" class="a-img">-->
                    <!--<img th:src="@{/waterfall/images/10.jpg}" alt="">-->

                    <!--</a>-->
                    <!--<h2 class="li-title" title="手把手教你用css3来创建loading动画(二)">手把手教你用css3来创建loading动画(二)</h2>-->
                    <!--<p class="description">HTML 5以前的标准由于考虑到浏览器安全问题并不允许直接跨域通信并不允许直接跨域通信并不允许直接跨域通信，于...</p>-->
                    <!--<div class="qianm clearfloat">-->
                    <!--<span class="sp1"><b>688</b>浏览</span>-->
                    <!--<span class="sp2">jq22</span>-->
                    <!--<span class="sp3">2小时前&nbsp;By</span>-->
                    <!--</div>-->
                    <!--</li>-->
                    <!--<li class="item">-->
                    <!--<a href="#" class="a-img">-->
                    <!--<img th:src="@{/waterfall/images/9.jpg}" alt="">-->

                    <!--</a>-->
                    <!--<h2 class="li-title" title="手把手教你用css3来创建loading动画(二)">手把手教你用css3来创建loading动画(二)</h2>-->
                    <!--<p class="description">HTML 5以前的标准由于考虑到浏览器安全问题并不允许直接跨域通信并不允许直接跨域通信并不允许直接跨域通信，于...</p>-->
                    <!--<div class="qianm clearfloat">-->
                    <!--<span class="sp1"><b>688</b>浏览</span>-->
                    <!--<span class="sp2">jq22</span>-->
                    <!--<span class="sp3">2小时前&nbsp;By</span>-->
                    <!--</div>-->
                    <!--</li>-->
                    <!--<li class="item">-->
                    <!--<a href="#" class="a-img">-->
                    <!--<img th:src="@{/waterfall/images/11.jpg}" alt="">-->

                    <!--</a>-->
                    <!--<h2 class="li-title" title="手把手教你用css3来创建loading动画(二)">手把手教你用css3来创建loading动画(二)</h2>-->
                    <!--<p class="description">HTML 5以前的标准由于考虑到浏览器安全问题并不允许直接跨域通信并不允许直接跨域通信并不允许直接跨域通信，于...</p>-->
                    <!--<div class="qianm clearfloat">-->
                    <!--<span class="sp1"><b>688</b>浏览</span>-->
                    <!--<span class="sp2">jq22</span>-->
                    <!--<span class="sp3">2小时前&nbsp;By</span>-->
                    <!--</div>-->
                    <!--</li>-->
                </ul>
            </div>
            <!-- loading按钮自己通过样式调整 -->
            <div id="imloading" style="width:150px;height:30px;line-height:30px;font-size:16px;text-align:center;border-radius:3px;opacity:0.7;background:#000;margin:10px auto 30px;color:#fff;display:none">
                素材加载中.....
            </div>
        </div>

    </main>


    <footer class="credit" style="margin-top: 0px; margin-bottom: 0px; width: 100%;text-align: center">
        Coded with repl by richard wong &copy; 2019 - <a href="https://www.codehim.com" rel="dofollow" title="Awesome Web Projects and Tutorials" target="_blank"> Codehim.com </a>
    </footer>


</div>


<!--DEMO ONLY FILES-->
<!--Demo CSS-->
<!--<link rel="stylesheet" th:href="@{/sidebar/docs/demo-only.css}" />-->
<script th:src="@{/sidebar/docs/demo-only.js}"></script>
<!--<script th:src="@{/editor/exp/js/jquery.min.js}"></script>-->
<script>
    function newmd() {

        var title= prompt("请输入新文档名","新建markdown");

        var jsonobj = new Object();
        jsonobj.title=title;
        jsonobj.mdcontent=null;


        $.ajax({
            type:"POST",
            dataType:"json",
            url:"/newmd",
            data:jsonobj,
            sucess:function (result) {
                if(result.resultCode==200)
                {
                    alert("创建成功");
                }
                else
                {
                    alert("新建失败:"+result.msg);
                }
            }

        });
    }

</script>

<!--waterfall script-->
<script type="text/javascript">
    /*
        抛开瀑布流布局各种乱七八糟的算法，基于masonry的瀑布流，很是简单的，而且通过扩展animate,能实现瀑布流布局的晃动、弹球等效果。
        masonry还有很多参数我这里注解了常用的参数
     */
    $(function(){
        /*瀑布流开始*/
        var container = $('.waterfull ul');
        var loading=$('#imloading');
        // 初始化loading状态
        loading.data("on",true);
        /*判断瀑布流最大布局宽度，最大为1280*/
        function tores(){
            var tmpWid=$(window).width();
            if(tmpWid>1280){
                tmpWid=1280;
            }else{
                var column=Math.floor(tmpWid/320);
                tmpWid=column*320;
            }
            $('.waterfull').width(tmpWid);
        }
        tores();
        $(window).resize(function(){
            tores();
        });
        container.imagesLoaded(function(){
            container.masonry({
                columnWidth: 320,
                itemSelector : '.item',
                isFitWidth: true,//是否根据浏览器窗口大小自动适应默认false
                isAnimated: true,//是否采用jquery动画进行重拍版
                isRTL:false,//设置布局的排列方式，即：定位砖块时，是从左向右排列还是从右向左排列。默认值为false，即从左向右
                isResizable: true,//是否自动布局默认true
                animationOptions: {
                    duration: 800,
                    easing: 'easeInOutBack',//如果你引用了jQeasing这里就可以添加对应的动态动画效果，如果没引用删除这行，默认是匀速变化
                    queue: false//是否队列，从一点填充瀑布流
                }
            });
        });
        /*模拟从后台获取到的数据*/
        //var sqlJson=[{'title':'瀑布流其实就是几个函数的事！','intro':'爆料，苏亚雷斯又咬人啦，C罗哪有内马尔帅，梅西今年要不夺冠，你就去泰国吧，老子买了阿根廷赢得彩票，输了就去不成了。','src':'/waterfall/images/one.jpg','writer':'jq22','date':'2小时前','looked':321},{'title':'瀑布流其实就是几个函数的事！','intro':'爆料了，苏亚雷斯又咬人啦，C罗哪有内马尔帅，梅西今年要不夺冠，你就去泰国吧，老子买了阿根廷赢得彩票，输了就去不成了。','src':'images/demo2.jpg','writer':'jq22','date':'2小时前','looked':321},{'title':'瀑布流其实就是几个函数的事！','intro':'爆料了，苏亚雷斯又咬人啦，C罗哪有内马尔帅，梅西今年要不夺冠，你就去泰国吧，老子买了阿根廷赢得彩票，输了就去不成了。','src':'images/p1.jpg','writer':'jq22','date':'2小时前','looked':321},{'title':'瀑布流其实就是几个函数的事！','intro':'爆料了，苏亚雷斯又咬人啦，C罗哪有内马尔帅，梅西今年要不夺冠，你就去泰国吧，老子买了阿根廷赢得彩票，输了就去不成了。','src':'images/p1.jpg','writer':'jq22','date':'2小时前','looked':321}];

        var sqlJson=null;
        // $(function()
        // {
        //     if(!loading.data("on")) return;
        //     // 计算所有瀑布流块中距离顶部最大，进而在滚动条滚动时，来进行ajax请求，方法很多这里只列举最简单一种，最易理解一种
        //     var itemNum=$('#waterfull').find('.item').length;
        //     var itemArr=[];
        //     itemArr[0]=$('#waterfull').find('.item').eq(itemNum-1).offset().top+$('#waterfull').find('.item').eq(itemNum-1)[0].offsetHeight;
        //     itemArr[1]=$('#waterfull').find('.item').eq(itemNum-2).offset().top+$('#waterfull').find('.item').eq(itemNum-1)[0].offsetHeight;
        //     itemArr[2]=$('#waterfull').find('.item').eq(itemNum-3).offset().top+$('#waterfull').find('.item').eq(itemNum-1)[0].offsetHeight;
        //     var maxTop=Math.max.apply(null,itemArr);
        //     if(maxTop<$(window).height()+$(document).scrollTop()){
        //         //加载更多数据
        //         loading.data("on",false).fadeIn(800);
        //         (function(sqlJson){
        //             /*这里会根据后台返回的数据来判断是否你进行分页或者数据加载完毕这里假设大于30就不在加载数据*/
        //             if(itemNum>30){
        //                 loading.text('就有这么多了！');
        //             }else{
        //                 var html="";
        //                 for(var i in sqlJson){
        //                     html+="<li class='item'><a href='#' class='a-img'><img src='"+sqlJson[i].src+"'></a>";
        //                     html+="<h2 class='li-title'>"+sqlJson[i].title+"</h2>";
        //                     html+="<p class='description'>"+sqlJson[i].intro+"</p><div class='qianm clearfloat'>";
        //                     html+="<span class='sp1'><b>"+sqlJson[i].looked+"</b>浏览</span>";
        //                     html+="<span class='sp2'>"+sqlJson[i].writer+"</span><span class='sp3'>"+sqlJson[i].date+"&nbsp;By</span></div></li>";
        //                 }
        //                 /*模拟ajax请求数据时延时800毫秒*/
        //                 var time=setTimeout(function(){
        //                     $(html).find('img').each(function(index){
        //                         loadImage($(this).attr('src'));
        //                     })
        //                     var $newElems = $(html).css({ opacity: 0}).appendTo(container);
        //                     $newElems.imagesLoaded(function(){
        //                         $newElems.animate({ opacity: 1},800);
        //                         container.masonry( 'appended', $newElems,true);
        //                         loading.data("on",true).fadeOut();
        //                         clearTimeout(time);
        //                     });
        //                 },800)
        //             }
        //         })(sqlJson);
        //     }
        // });
        //
        // /*本应该通过ajax从后台请求过来类似sqljson的数据然后，便利，进行填充，这里我们用sqlJson来模拟一下数据*/
        $(function(){
            ReloadList();
            //reload();
        });

        function reload() {


            if(!loading.data("on")) return;
            //计算所有瀑布流块中距离顶部最大，进而在滚动条滚动时，来进行ajax请求，方法很多这里只列举最简单一种，最易理解一种
            //var itemNum=$('#waterfull').find('.item').length;
            //var itemArr=[];
            //itemArr[0]=$('#waterfull').find('.item').eq(itemNum-1).offset().top+$('#waterfull').find('.item').eq(itemNum-1)[0].offsetHeight;
            //itemArr[1]=$('#waterfull').find('.item').eq(itemNum-2).offset().top+$('#waterfull').find('.item').eq(itemNum-1)[0].offsetHeight;
            //itemArr[2]=$('#waterfull').find('.item').eq(itemNum-3).offset().top+$('#waterfull').find('.item').eq(itemNum-1)[0].offsetHeight;
            //var maxTop=Math.max.apply(null,itemArr);
            //if(maxTop<$(window).height()+$(document).scrollTop()){
            //加载更多数据
            loading.data("on",false).fadeIn(800);
            (function(sqlJson){
                /*这里会根据后台返回的数据来判断是否你进行分页或者数据加载完毕这里假设大于30就不在加载数据*/
                //if(itemNum>30){
                //	loading.text('就有这么多了！');
                //}else{
                var html="";
                var tmp=0;
                for(var i in sqlJson){
                    tmp=tmp%13;
                    var imgsrc="/waterfall/images/"+tmp.toString()+".jpg";
                    tmp++;

                    html+="<li onclick='DoEdit(this)' uid='"+sqlJson[i].uid+"' class='item'><a href='#' class='a-img'><img src='"+imgsrc.toString()+"'></a>";
                    html+="<h2 style='color: black' class='li-title'>"+sqlJson[i].title+"</h2>";
                    html+="<p class='description'>"+sqlJson[i].intro+"</p><div class='qianm clearfloat'>";
                    html+="<span class='sp1'><b>"+sqlJson[i].opencount+"</b>次打开</span>";
                    html+="<span class='sp2'>"+sqlJson[i].nickname+"</span><span class='sp3'>"+sqlJson[i].date+"&nbsp;By</span></div></li>";
                }
                /*模拟ajax请求数据时延时800毫秒*/
                //var time=setTimeout(function(){
                $(html).find('img').each(function(index){
                    loadImage($(this).attr('src'));
                })
                var $newElems = $(html).css({ opacity: 0}).appendTo(container);
                $newElems.imagesLoaded(function(){
                    $newElems.animate({ opacity: 1},800);
                    //container.masonry( 'appended', $newElems,true);
                    container.masonry( 'reload');
                    loading.data("on",true).fadeOut();
                    //clearTimeout(time);
                });
                //},800)
                //}
            })(sqlJson);
            //}

        }

        function loadImage(url) {
            var img = new Image();
            //创建一个Image对象，实现图片的预下载
            img.src = url;
            if (img.complete) {
                return img.src;
            }
            img.onload = function () {
                return img.src;
            };
        };
        //loadImage('/waterfall/images/one.jpg');

        function ReloadList() {

            // $.ajax({
            //     async:false,
            //     type:"GET",
            //     url:"/list",
            //     contentType: 'application/json,charset = utf-8',
            //     sucess:function (result) {
            //         console.log("suc");
            //         if(result.resultCode==200)
            //         {
            //             console.log("200");
            //             sqlJson=result;
            //             reload();
            //         }
            //         else
            //         {
            //             alert("获取列表失败");
            //         }
            //     },
            //     error:function (result) {
            //         console.log("fail");
            //     }
            // });
            var xmlHttp = new XMLHttpRequest();
            xmlHttp.onreadystatechange = function() {
                if (xmlHttp.readyState == 4 && xmlHttp.status == 200)
                {
                    sqlJson = JSON.parse(xmlHttp.responseText) ;
                    reload();
                }
                //callback(xmlHttp.responseText);
            }
            xmlHttp.open("GET", "/list", true); // true for asynchronous
            xmlHttp.send(null);
        }

        /*item hover效果*/
        var rbgB=['#71D3F5','#F0C179','#F28386','#8BD38B'];
        $('#waterfull').on('mouseover','.item',function(){
            var random=Math.floor(Math.random() * 4);
            $(this).stop(true).animate({'backgroundColor':rbgB[random]},1000);
        });
        $('#waterfull').on('mouseout','.item',function(){
            $(this).stop(true).animate({'backgroundColor':'#fff'},1000);
        });

        $('#reload').click(function () {

            container.empty();
            ReloadList();
        });

    })
</script>
<script>
    function DoEdit(obj)
    {
        var uid=obj.getAttribute("uid");
        var form = document.createElement("form");
        // 设置form属性
        form .action = "/edit";
        form .target = "_self";
        form .method = "post";
        form .style.display = "none";

        var input=document.createElement("input");
        input.type="text";
        input.name="uid";
        input.value=uid;

        form.appendChild(input);

        document.body.appendChild(form);
        // 提交表单
        form .submit();
    }
</script>

</body>
</html>
